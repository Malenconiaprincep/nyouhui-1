extends ../../layouts/index

block append title

block append meta

block append stylesheet

block append headjs

block append content
  // Main content
  section.content
    form(role="form",data-module="manage_form",data-db=result.db,data-collection=result.collection)
      div
        - var data = result.data[result.db][result.collection];
        - var schema = result.data[result.schema.db][result.schema.collection];
        - var types = result.types;
        if data && data._id
          +manage_ctrl_input({
            name:'_id',
            type:'hidden',
            value:(data ? data._id + '' : '')
          })
        each field in schema.fields
          - var extra_componets = types.filter(function(v){
          -   return v.name == field.type
          - })
          - field.base = extra_componets[0].base;
          if field.base === 'input'
            -var params = {};
            -params.label = field.alias;
            -params.name =field.name,
            -params.value = data ? data[field.name] : field.defaults
            - for(var key in extra_componets[0].params)
            -   params[key] = extra_componets[0].params[key]
            +manage_ctrl_input(params)
          else if field.base === 'password'
            -var params = {};
            -params.label = field.alias;
            -params.name =field.name,
            -params.value = data ? data[field.name] : '',
            - for(var key in extra_componets[0].params)
            -   params[key] = extra_componets[0].params[key]
            +manage_ctrl_input(params)
          else if field.base === 'tag'
            -var params = {};
            -params.label = field.alias;
            -params.name =field.name,
            -params.value = data ? data[field.name].join(' ') : ''
            - for(var key in extra_componets[0].params)
            -   params[key] = extra_componets[0].params[key]
            +manage_ctrl_tagsinput(params)
      +manage_box({
        title:'表定义'
      })
      .form-group
        button.btn.btn-primary.btn-schema-add(type="submit") 确定
        | 
        a.btn.btn-default.btn-cancel 取消

block append footjs
  script(type="text/javascript",src="//static.nyouhui.com/dist/js/manage/crud.min.60d765a147be2bf2.js")